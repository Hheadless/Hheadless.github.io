<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>axios | 前端学习记</title>
    <meta name="description" content="学习使我快乐 快乐使我学习">
    <link rel="icon" href="/icon.png">
    
    <link rel="preload" href="/assets/css/0.styles.ac8064d8.css" as="style"><link rel="preload" href="/assets/js/app.a67150ac.js" as="script"><link rel="preload" href="/assets/js/8.e6b142d6.js" as="script"><link rel="prefetch" href="/assets/js/10.3ecfb360.js"><link rel="prefetch" href="/assets/js/11.a53da169.js"><link rel="prefetch" href="/assets/js/12.36343f29.js"><link rel="prefetch" href="/assets/js/13.3ce8487e.js"><link rel="prefetch" href="/assets/js/14.ab2276f9.js"><link rel="prefetch" href="/assets/js/15.2ed45e60.js"><link rel="prefetch" href="/assets/js/16.d04c56db.js"><link rel="prefetch" href="/assets/js/17.cfbf53bf.js"><link rel="prefetch" href="/assets/js/18.ef18080c.js"><link rel="prefetch" href="/assets/js/19.9f55773b.js"><link rel="prefetch" href="/assets/js/2.0c8a8f47.js"><link rel="prefetch" href="/assets/js/3.58045c23.js"><link rel="prefetch" href="/assets/js/4.5cca1ceb.js"><link rel="prefetch" href="/assets/js/5.0e5f781a.js"><link rel="prefetch" href="/assets/js/6.8ebe265e.js"><link rel="prefetch" href="/assets/js/7.8f971d75.js"><link rel="prefetch" href="/assets/js/9.052d62d5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ac8064d8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端学习记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识点</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/focus/githubIo.html" class="nav-link">快速搭建github个人站</a></li><li class="dropdown-item"><!----> <a href="/focus/broken.html" class="nav-link">零散知识点</a></li><li class="dropdown-item"><!----> <a href="/focus/axios.html" class="nav-link router-link-exact-active router-link-active">axios</a></li><li class="dropdown-item"><!----> <a href="/focus/pageLayout.html" class="nav-link">页面布局</a></li><li class="dropdown-item"><!----> <a href="/vue/vue.html" class="nav-link">vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/focus/axios.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/Hheadless" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识点</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/focus/githubIo.html" class="nav-link">快速搭建github个人站</a></li><li class="dropdown-item"><!----> <a href="/focus/broken.html" class="nav-link">零散知识点</a></li><li class="dropdown-item"><!----> <a href="/focus/axios.html" class="nav-link router-link-exact-active router-link-active">axios</a></li><li class="dropdown-item"><!----> <a href="/focus/pageLayout.html" class="nav-link">页面布局</a></li><li class="dropdown-item"><!----> <a href="/vue/vue.html" class="nav-link">vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/focus/axios.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/Hheadless" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>axios</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/focus/axios.html#axios" class="sidebar-link">axios</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/focus/axios.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#get请求" class="sidebar-link">GET请求</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#post请求" class="sidebar-link">POST请求</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#同时发起多个请求" class="sidebar-link">同时发起多个请求</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#请求方法别名" class="sidebar-link">请求方法别名</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#创建实例" class="sidebar-link">创建实例</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#拦截器" class="sidebar-link">拦截器</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#请求配置" class="sidebar-link">请求配置</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#默认配置" class="sidebar-link">默认配置</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#配置优先级" class="sidebar-link">配置优先级</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#错误处理" class="sidebar-link">错误处理</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#反向代理模拟http中host和referer" class="sidebar-link">反向代理模拟http中host和referer</a></li><li class="sidebar-sub-header"><a href="/focus/axios.html#axios请求超时" class="sidebar-link">axios请求超时</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="axios"><a href="#axios" aria-hidden="true" class="header-anchor">#</a> axios</h2> <h3 id="安装"><a href="#安装" aria-hidden="true" class="header-anchor">#</a> 安装</h3> <pre><code>1.  npm 安装
$ npm install axios

2.  cdn 引入
&lt;script src=&quot;https://unpkg.com/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt;
</code></pre> <h3 id="get请求"><a href="#get请求" aria-hidden="true" class="header-anchor">#</a> GET请求</h3> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/url?id=12&amp;paw=23'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>params<span class="token punctuation">:</span><span class="token punctuation">{</span>id<span class="token punctuation">:</span><span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="post请求"><a href="#post请求" aria-hidden="true" class="header-anchor">#</a> POST请求</h3> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token punctuation">:</span><span class="token number">123</span><span class="token punctuation">,</span>name<span class="token punctuation">:</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="同时发起多个请求"><a href="#同时发起多个请求" aria-hidden="true" class="header-anchor">#</a> 同时发起多个请求</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getUserAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/url/123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// GET时默认的请求方法</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getUserPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/url/123/permissions'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

axios<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">getUserAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getUserPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">spread</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">acct<span class="token punctuation">,</span>perms</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 两个请求现在都执行完成</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>同时发生的请求</strong></p> <pre><code>以下两个用来处理同时发生多个请求的辅助函数
axios.all(iterable)
axios.spread(callback)
</code></pre> <h3 id="请求方法别名"><a href="#请求方法别名" aria-hidden="true" class="header-anchor">#</a> 请求方法别名</h3> <p>为了方便我们为所有支持的请求方法均提供了别名。</p> <pre><code>axios.request(config)
axios.get(url[, config])
axios.delete(url[, config])
axios.head(url[, config])
axios.options(url[, config])
axios.post(url[, data[, config]])
axios.put(url[, data[, config]])
axios.patch(url[, data[, config]])

注释: 当使用以上别名方法时，url，method和data等属性不用在config重复声明。
</code></pre> <h3 id="创建实例"><a href="#创建实例" aria-hidden="true" class="header-anchor">#</a> 创建实例</h3> <p><strong>axios.create([config])</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseURL<span class="token punctuation">:</span> <span class="token string">'https://some-domain.com/api/'</span><span class="token punctuation">,</span>
    timeout<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'X-Custom-Header'</span><span class="token punctuation">:</span> <span class="token string">'foobar'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="拦截器"><a href="#拦截器" aria-hidden="true" class="header-anchor">#</a> 拦截器</h3> <ul><li>在请求或响应时拦截下来进行处理。(做点什么)</li> <li>在请求或响应被 then 或 catch 处理前拦截它们。(什么时候发生)</li></ul> <p><strong>拦截器分为请求拦截器和响应拦截器。</strong></p> <ul><li><p>请求拦截器(interceptors.request) 是指可以拦截每次或指定HTTP请求，并可以修改配置项。</p></li> <li><p>响应拦截器（interceptors.response）可以在每次HTTP请求后拦截住每次或指定HTTP请求，并可修改返回结果项。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 添加请求拦截器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在发送请求前做点啥</span>
    <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对请求错误做点啥</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>retry <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// 设置全局请求的次数，请求的间隙</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>retryDelay <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment">// 失败请求之间等待的毫秒数(默认为1)</span>
<span class="token comment">// 添加响应拦截器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token number">404</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 拦截状态码。做一些自己的需求</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 抛出错误信息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果你想在稍后移除拦截器，可以这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 移除拦截器</span>
<span class="token keyword">var</span> myInterceptor <span class="token operator">=</span> axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">eject</span><span class="token punctuation">(</span>myInterceptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你也可以为axios实例添加一个拦截器</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 自定义axios实例添加拦截器</span>
<span class="token keyword">var</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="请求配置"><a href="#请求配置" aria-hidden="true" class="header-anchor">#</a> 请求配置</h3> <p>下面是所有可用的请求配置项，只有<code>url</code>是必填，默认的请求方法是<code>GET</code>，如果没有指定请求方法的话。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
     <span class="token comment">// 请求的接口地址</span>
    url<span class="token punctuation">:</span> <span class="token string">'/url'</span><span class="token punctuation">,</span>
    <span class="token comment">// 请求方法。默认为get</span>
    method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
    
    <span class="token comment">//  baseURL将自动加在 url 前面。除非 url 是一个绝对路径</span>
    <span class="token comment">// 可用来区分不同环境时使用。</span>
    baseURL<span class="token punctuation">:</span> <span class="token string">'https://some-domain.com/api/'</span><span class="token punctuation">,</span>  
    
    <span class="token comment">// 用于请求之前对请求数据进行操作</span>
    <span class="token comment">// 只有在使用请求方法为'PUT','POST','PATCH'时可用。</span>
    <span class="token comment">// 可以修改headers对象</span>
    transformRequest<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>headers</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 可以对data做任何操作</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// 用于对相应数据进行处理</span>
    <span class="token comment">// 它会通过then或者catch</span>
    transformResponse<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 可以对data做任何操作</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// headers 发送自定义Headers 头文件，这里包含了HTTP请求的各种信息</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// URL参数，必须是一个纯对象或者 URL参数对象。会被拼接在地址后面</span>
    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">123</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// params参数序列化器</span>
    <span class="token function-variable function">paramsSerializer</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token punctuation">{</span>arrayFormat<span class="token punctuation">:</span> <span class="token string">'brackets'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//  请求体数据</span>
    <span class="token comment">// 只有当请求方法为 'PUT','POST','PATCH'时可用</span>
    <span class="token comment">// 如果没有设置 transformRequest ，必须是以下</span>
    data<span class="token punctuation">:</span><span class="token punctuation">{</span>
        firstName<span class="token punctuation">:</span> <span class="token string">'name'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 请求超时事件(毫秒),如果超时 请求将被中止</span>
    timeout<span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token comment">//  表明是否有跨域请求需要用到证书</span>
    withCredentials<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">//  允许用户自定义处理请求，这使得测试更容易。</span>
    <span class="token comment">// 返回一个Promise和一个有效的 response</span>
    <span class="token function-variable function">adapter</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//  `auth’表示应该使用 HTTP 基本认证，并提供凭据。</span>
    <span class="token comment">//  这将会在headers中设置一个Authorization授权信息。使用headers设置。</span>
    auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> <span class="token string">'janedoe'</span><span class="token punctuation">,</span>
        password<span class="token punctuation">:</span> <span class="token string">'s00pers3cret'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 服务器将响应的数据类型</span>
    <span class="token comment">// 类型包括 ‘arraybuffer’, ‘blob’, ‘document’, ‘json’, ‘text’, ‘stream’</span>
    <span class="token comment">// 默认为 json</span>
    responseType<span class="token punctuation">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
    <span class="token comment">// 是要用作 xsrf 令牌的值的cookie的名称</span>
    xsrfCookieName<span class="token punctuation">:</span> <span class="token string">'XSRF-TOKEN'</span><span class="token punctuation">,</span>
    <span class="token comment">// 是携带 xsrf 令牌值的http头的名称</span>
    xsrfHeaderName<span class="token punctuation">:</span> <span class="token string">'X-XSRF-TOKEN'</span><span class="token punctuation">,</span>
    <span class="token comment">// 允许在上传过程中的做一些操作</span>
    <span class="token function-variable function">onUploadProgress</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">progressEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 使用本地 progress 事件做任何你想做的</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 允许在下载过程中的做一些操作</span>
    <span class="token function-variable function">onDownloadProgress</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">progressEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 定义接收到的 response 响应数据的最大长度</span>
    maxContentLength<span class="token punctuation">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
    <span class="token comment">// validateStatus定义 根据HTTP响应状态码 决定 是否解析或拒绝给定的promise</span>
    <span class="token comment">// 如果 validateStatus 返回 true (或设置为null,或undefined) ,promise将被接受；否则，promise将被拒绝。</span>
    <span class="token function-variable function">validateStatus</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">;</span> <span class="token comment">// default</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token comment">// 定义在nodeJS中要遵循的重定向的最大数</span>
    <span class="token comment">// 如果设置为 0，则不会遵循重定向</span>
    maxRedirects<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 默认值</span>
    <span class="token comment">//  定义在nodeJS使用 http 请求时的自定义代理</span>
    httpAgent<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">http<span class="token punctuation">.</span>Agent</span><span class="token punctuation">(</span><span class="token punctuation">{</span> keepAlive<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">//  定义在nodeJS使用 https 请求时的自定义代理</span>
    httpsAgent<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">https<span class="token punctuation">.</span>Agent</span><span class="token punctuation">(</span><span class="token punctuation">{</span> keepAlive<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token comment">//  定义代理服务器的主机名和端口.</span>
    <span class="token comment">//  这将设置一个`Proxy-Authorization` header，覆盖任何使用`headers`设置的现有的`Proxy-Authorization` 自定义 headers。</span>
    proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        host<span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
        port<span class="token punctuation">:</span> <span class="token number">9000</span><span class="token punctuation">,</span>
        <span class="token comment">// `auth`表示HTTP Basic auth应该用于连接到代理，并提供证书。</span>
        auth<span class="token punctuation">:</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            username<span class="token punctuation">:</span> ’mikeymike’<span class="token punctuation">,</span>
            password<span class="token punctuation">:</span> ’rapunz3l’
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//  cancelToken定义一个 cancel token 用于取消请求</span>
    cancelToken<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">CancelToken</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cancel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="默认配置"><a href="#默认配置" aria-hidden="true" class="header-anchor">#</a> 默认配置</h3> <p><strong>全局修改axios默认配置</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">'https://api.example.com'</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>common<span class="token punctuation">[</span><span class="token string">'Authorization'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">AUTH_TOKEN</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>post<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>实例默认配置</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建实例时修改配置</span>
<span class="token keyword">var</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token punctuation">:</span> <span class="token string">'https://api.example.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 实例创建之后修改配置</span>
instance<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>common<span class="token punctuation">[</span><span class="token string">'Authorization'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">AUTH_TOKEN</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="配置优先级"><a href="#配置优先级" aria-hidden="true" class="header-anchor">#</a> 配置优先级</h3> <p>配置项通过一定的规则合并，<code>request config &gt; instance.defaults &gt;</code> 系统默认，优先级高的覆盖优先级低的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建一个实例，这时的超时时间为系统默认的 0</span>
<span class="token keyword">var</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过instance.defaults重新设置超时时间为2.5s，因为优先级比系统默认高</span>
instance<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span>

<span class="token comment">// 通过request config重新设置超时时间为5s，因为优先级比instance.defaults和系统默认都高</span>
instance<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/longRequest'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  timeout<span class="token punctuation">:</span> <span class="token number">5000</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="错误处理"><a href="#错误处理" aria-hidden="true" class="header-anchor">#</a> 错误处理</h3> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/12345'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 发送请求后，服务端返回的响应码不是 2xx   </span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 发送请求但是没有响应返回</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 其他错误</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="反向代理模拟http中host和referer"><a href="#反向代理模拟http中host和referer" aria-hidden="true" class="header-anchor">#</a> 反向代理模拟http中host和referer</h3> <p><strong>referer:</strong>
HTTP referer 是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上referer,告诉服务器我从哪个页面来的，服务器基于此可以获得一些信息进行处理，当然服务器可以检查请求来源页面的host和referer,并做相应的限制。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在webpack.dev.conf.js文件中进行配置</span>
<span class="token function">before</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/getList&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&quot;http://.....&quot;</span><span class="token punctuation">;</span>
        axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token punctuation">{</span>
            headers<span class="token punctuation">:</span><span class="token punctuation">{</span>
                referer<span class="token punctuation">:</span> <span class="token string">&quot;https://c.y.com&quot;</span><span class="token punctuation">,</span>
                host<span class="token punctuation">:</span> <span class="token string">&quot;c.y.com&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            params<span class="token punctuation">:</span> req<span class="token punctuation">.</span>query
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="axios请求超时"><a href="#axios请求超时" aria-hidden="true" class="header-anchor">#</a> axios请求超时</h3> <p><img src="/img/axiosInterceptors.png" alt="img"></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Hheadless/edit/master/docs/focus/axios.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-5-21 16:19:35</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.a67150ac.js" defer></script><script src="/assets/js/8.e6b142d6.js" defer></script>
  </body>
</html>
